<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estimate Billing - Retail Shop Pro</title>
    <!-- ... skipping head ... -->
    <div class="container" style="padding-top: 2rem;">
        <div class="flex-between mb-3">
            <h1>Estimate Billing</h1>
            <button class="btn btn-danger" onclick="EstimateManager.clearCart()">Clear Cart</button>
        </div>

        <div class="billing-layout">
            <!-- Left: Product Search & Cart -->
            <div>
                <!-- Customer Info -->
                <div class="glass-card mb-3">
                    <h3>Customer Information</h3>
                    <div class="grid grid-2">
                        <div class="form-group">
                            <label class="form-label">Customer Name</label>
                            <input type="text" class="form-input" id="customerName"
                                placeholder="Customer / Business Name">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Phone Number</label>
                            <input type="tel" class="form-input" id="customerPhone" placeholder="Optional"
                                oninput="this.value = this.value.replace(/[^0-9+\-\s()]/g, '')">
                        </div>
                    </div>
                    <div class="form-group mt-2">
                        <label class="form-label">Date</label>
                        <input type="date" class="form-input" id="billDate">
                    </div>
                    <div class="grid grid-2 mt-2">
                        <div class="form-group">
                            <label class="form-label">Address</label>
                            <textarea class="form-input" id="customerAddress" placeholder="Address" rows="2"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Billing Notes (Optional)</label>
                            <textarea class="form-input" id="billingNotes" placeholder="Additional notes..."
                                rows="2"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Product Search -->
                <div class="glass-card mb-3">
                    <h3>Add Products</h3>
                    <div class="product-search">
                        <input type="text" class="form-input" id="productSearch" placeholder="Search products..."
                            autocomplete="off">
                        <div id="searchResults" class="search-results hidden"></div>
                    </div>
                </div>

                <!-- Cart -->
                <div class="glass-card">
                    <h3>Items</h3>
                    <div id="cartEmpty" class="text-center text-muted" style="padding: 2rem;">
                        <p style="font-size: 3rem; margin-bottom: 1rem;">ðŸ›’</p>
                        <p>No items added.</p>
                    </div>
                    <div id="cartItems"></div>
                </div>
            </div>

            <!-- Right: Bill Summary -->
            <div>
                <div class="glass-card" style="position: sticky; top: 100px;">
                    <h3>Summary</h3>
                    <div id="billSummary" class="invoice-summary">
                        <div class="summary-row total">
                            <span>Total:</span>
                            <strong>â‚¹0.00</strong>
                        </div>
                    </div>


                    <button class="btn btn-success mt-3" style="width: 100%;" onclick="EstimateManager.generateBill()">
                        Generate Estimate
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/database.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/products.js"></script>
    <script src="js/estimate.js"></script>
    <script src="js/pdf.js"></script>
    <script>
        // Check authentication
        Auth.requireLogin();

        // Display user info
        const user = Auth.getCurrentUser();
        document.getElementById('userDisplay').textContent = `Welcome, ${user.name}`;

        // Hide Home button for billing users (non-admin)
        if (user.role !== 'admin') {
            const homeButton = document.getElementById('homeButton');
            if (homeButton) {
                homeButton.style.display = 'none';
            }
        }

        // Initialize billing
        EstimateManager.init();
    </script>
    </body>

</html>